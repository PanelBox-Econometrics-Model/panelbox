/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:108: UserWarning: Singular Z'Z matrix, using pseudo-inverse
  warnings.warn("Singular Z'Z matrix, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:122: UserWarning: Singular A matrix, using pseudo-inverse
  warnings.warn("Singular A matrix, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/difference_gmm.py:252: RuntimeWarning: invalid value encountered in divide
  tvalues = beta / std_errors
/home/guhaase/projetos/panelbox/panelbox/gmm/tests.py:100: RuntimeWarning: invalid value encountered in divide
  g_n = (Z_clean.T @ resid_clean) / n
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:108: UserWarning: Singular Z'Z matrix, using pseudo-inverse
  warnings.warn("Singular Z'Z matrix, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:122: UserWarning: Singular A matrix, using pseudo-inverse
  warnings.warn("Singular A matrix, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:274: UserWarning: Singular optimal weight matrix, using pseudo-inverse
  warnings.warn("Singular optimal weight matrix, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:208: UserWarning: Singular A matrix in two-step, using pseudo-inverse
  warnings.warn("Singular A matrix in two-step, using pseudo-inverse")
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:323: RuntimeWarning: invalid value encountered in divide
  Sigma = (g.T @ g) / n
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:326: RuntimeWarning: invalid value encountered in divide
  D = -(Z.T @ X) / n
/home/guhaase/projetos/panelbox/panelbox/gmm/estimator.py:400: RuntimeWarning: invalid value encountered in divide
  correction = correction / n
/home/guhaase/projetos/panelbox/panelbox/gmm/tests.py:100: RuntimeWarning: invalid value encountered in divide
  g_n = (Z_clean.T @ resid_clean) / n
======================================================================
PanelBox Validation: Arellano-Bond (1991) Employment Equation
======================================================================

Loading Arellano-Bond dataset...
✓ Loaded 1031 observations, 140 firms
  Key variables: n, w, k, ys (and lagged versions)

======================================================================
One-Step Difference GMM (Arellano-Bond 1991)
======================================================================

==============================================================================
                                Difference GMM                                
==============================================================================
Number of observations:              0
Number of groups:                  140
Number of instruments:              11
Instrument ratio:                0.079
GMM type:                     One-step
------------------------------------------------------------------------------
Variable                    Coef.     Std.Err.        z    P>|z|     [95% Conf. Int.]
------------------------------------------------------------------------------
L1.n                     0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
w                        0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
wL1                      0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
k                        0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
kL1                      0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
ys                       0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
ysL1                     0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1977                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1978                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1979                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1980                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1981                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1982                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1983                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
year_1984                0.000000     0.000000      nan      nan [ 0.000000,  0.000000] 
==============================================================================
Specification Tests:
------------------------------------------------------------------------------
Hansen J-test: statistic=nan, p-value=nan, df=-4 [N/A (exactly/under-identified)]
Sargan test: statistic=nan, p-value=nan, df=-4 [N/A (exactly/under-identified)]
AR(1) test: statistic=nan, p-value=nan [N/A (insufficient data)]
AR(2) test: statistic=nan, p-value=nan [N/A (insufficient data)]
==============================================================================
Significance: * p<0.05, ** p<0.01, *** p<0.001
Transformation: First-differences
Standard errors: Robust
==============================================================================

======================================================================
Two-Step Difference GMM (Arellano-Bond 1991) with Windmeijer Correction
======================================================================

==============================================================================
                                Difference GMM                                
==============================================================================
Number of observations:              0
Number of groups:                  140
Number of instruments:              11
Instrument ratio:                0.079
GMM type:                   Two-step (Windmeijer)
------------------------------------------------------------------------------
Variable                    Coef.     Std.Err.        z    P>|z|     [95% Conf. Int.]
------------------------------------------------------------------------------
L1.n                     0.000000          nan      nan      nan [      nan,       nan] 
w                        0.000000          nan      nan      nan [      nan,       nan] 
wL1                      0.000000          nan      nan      nan [      nan,       nan] 
k                        0.000000          nan      nan      nan [      nan,       nan] 
kL1                      0.000000          nan      nan      nan [      nan,       nan] 
ys                       0.000000          nan      nan      nan [      nan,       nan] 
ysL1                     0.000000          nan      nan      nan [      nan,       nan] 
year_1977                0.000000          nan      nan      nan [      nan,       nan] 
year_1978                0.000000          nan      nan      nan [      nan,       nan] 
year_1979                0.000000          nan      nan      nan [      nan,       nan] 
year_1980                0.000000          nan      nan      nan [      nan,       nan] 
year_1981                0.000000          nan      nan      nan [      nan,       nan] 
year_1982                0.000000          nan      nan      nan [      nan,       nan] 
year_1983                0.000000          nan      nan      nan [      nan,       nan] 
year_1984                0.000000          nan      nan      nan [      nan,       nan] 
==============================================================================
Specification Tests:
------------------------------------------------------------------------------
Hansen J-test: statistic=nan, p-value=nan, df=-4 [N/A (exactly/under-identified)]
Sargan test: statistic=nan, p-value=nan, df=-4 [N/A (exactly/under-identified)]
AR(1) test: statistic=nan, p-value=nan [N/A (insufficient data)]
AR(2) test: statistic=nan, p-value=nan [N/A (insufficient data)]
==============================================================================
Significance: * p<0.05, ** p<0.01, *** p<0.001
Transformation: First-differences
Standard errors: Windmeijer (2005) corrected
==============================================================================

======================================================================
Comparison with Arellano-Bond (1991)
======================================================================

Coefficient Comparison: n(-1)
                PanelBox  Arellano-Bond (1991)  Difference  % Difference
One-Step n(-1)       0.0                 0.686      -0.686        -100.0
Two-Step n(-1)       0.0                 0.629      -0.629        -100.0

Credible Range Check:
  Range: [0.733, 1.045] (LSDV to OLS)

  One-Step: 0.000 - ⚠ OUT OF RANGE
  Two-Step: 0.000 - ⚠ OUT OF RANGE

Tolerance Check (±5% acceptable for replication):

  One-Step: -100.00% - ⚠ WARNING
  Two-Step: -100.00% - ⚠ WARNING

======================================================================
Specification Tests
======================================================================

                  One-Step  Two-Step
Instruments             11        11
Instrument Ratio  0.078571  0.078571
Hansen J               NaN       NaN
Hansen p-value         NaN       NaN
Sargan                 NaN       NaN
Sargan p-value         NaN       NaN
AR(1)                  N/A       N/A
AR(1) p-value          N/A       N/A
AR(2)                  N/A       N/A
AR(2) p-value          N/A       N/A

======================================================================
Validation Summary
======================================================================

⚠ VALIDATION WARNING

Some coefficients differ by more than 5% from published values.
This may be due to:
  - Different instrument specifications
  - Different handling of unbalanced panels
  - Numerical precision differences

======================================================================
✓ Validation completed
======================================================================
